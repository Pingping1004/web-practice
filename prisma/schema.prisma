generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  User
  Staff
  Admin
}

enum AuthProvider {
  Local
  Google
}

model User {
  userId            String          @id @default(uuid())
  username          String          @unique
  email             String         @unique
  password          String?
  createdAt         DateTime        @default(now())
  role              Role            @default(User)
  provider          AuthProvider    @default(Local)

  oauthAccounts     OAuthAccount[]
  sessions          Session[]
}

model OAuthAccount {
  oauthId           String          @id @default(uuid())
  provider          String
  providerUserId    String          @unique
  userId            String
  user              User            @relation(fields: [userId], references: [userId])
}

model Session {
  sessionId         String          @id @default(uuid())
  jti               String          @unique
  hashedToken       String          @unique
  userId            String
  expiresAt         DateTime
  issuedAt         DateTime         @default(now())
  isUsed            Boolean         @default(false)
  isRevoked         Boolean         @default(false)
  ipAddress         String?
  userAgent         String?

  user              User            @relation(fields: [userId], references: [userId], onDelete: Cascade)
}